---
interface Props {
  variant?: 'petals' | 'cupids' | 'hearts' | 'all';
  density?: 'light' | 'medium' | 'heavy';
}

const { variant = 'all', density = 'medium' } = Astro.props;

const petals = ['ğŸŒ¸', 'ğŸ’•', 'ğŸ©·', 'ğŸ’—', 'ğŸª»'];
const cupids = ['ğŸ’˜', 'ğŸ’', 'ğŸ’–'];
const hearts = ['â¤ï¸', 'ğŸ’•', 'ğŸ’—', 'ğŸ’“'];

const counts = {
  light: { petals: 8, cupids: 2, hearts: 5 },
  medium: { petals: 15, cupids: 4, hearts: 8 },
  heavy: { petals: 25, cupids: 6, hearts: 12 }
};

const count = counts[density];
---

<div class="decorations-container fixed inset-0 pointer-events-none overflow-hidden z-10">
  <!-- Falling Petals -->
  {(variant === 'petals' || variant === 'all') && (
    <div class="petals-layer">
      {Array.from({ length: count.petals }).map((_, i) => (
        <span
          class="petal"
          style={`
            --fall-duration: ${8 + Math.random() * 12}s;
            --fall-delay: ${Math.random() * 10}s;
            --fall-left: ${Math.random() * 100}%;
            font-size: ${14 + Math.random() * 16}px;
            opacity: ${0.4 + Math.random() * 0.4};
            filter: blur(${Math.random() > 0.7 ? '1px' : '0'});
          `}
        >
          {petals[Math.floor(Math.random() * petals.length)]}
        </span>
      ))}
    </div>
  )}

  <!-- Floating Cupids -->
  {(variant === 'cupids' || variant === 'all') && (
    <div class="cupids-layer">
      {Array.from({ length: count.cupids }).map((_, i) => (
        <span
          class="cupid"
          style={`
            --float-delay: ${Math.random() * 4}s;
            top: ${10 + Math.random() * 70}%;
            left: ${5 + (i * (90 / count.cupids))}%;
            font-size: ${24 + Math.random() * 20}px;
            opacity: ${0.3 + Math.random() * 0.4};
            filter: blur(${Math.random() > 0.5 ? '1px' : '0'});
          `}
        >
          {cupids[Math.floor(Math.random() * cupids.length)]}
        </span>
      ))}
    </div>
  )}

  <!-- Floating Hearts (Background) -->
  {(variant === 'hearts' || variant === 'all') && (
    <div class="hearts-layer">
      {Array.from({ length: count.hearts }).map((_, i) => (
        <span
          class="absolute animate-float"
          style={`
            animation-delay: ${Math.random() * 5}s;
            animation-duration: ${5 + Math.random() * 5}s;
            top: ${Math.random() * 100}%;
            left: ${Math.random() * 100}%;
            font-size: ${12 + Math.random() * 18}px;
            opacity: ${0.15 + Math.random() * 0.25};
          `}
        >
          {hearts[Math.floor(Math.random() * hearts.length)]}
        </span>
      ))}
    </div>
  )}

  <!-- Corner Decorations -->
  <div class="corner-decorations">
    <!-- Top Left -->
    <div class="absolute top-4 left-4 text-4xl opacity-20 animate-pulse">
      ğŸ’
    </div>

    <!-- Top Right -->
    <div class="absolute top-4 right-4 text-4xl opacity-20 animate-pulse" style="animation-delay: 1s;">
      ğŸŒ¹
    </div>

    <!-- Bottom Left -->
    <div class="absolute bottom-4 left-4 text-4xl opacity-20 animate-pulse" style="animation-delay: 2s;">
      ğŸ’
    </div>

    <!-- Bottom Right -->
    <div class="absolute bottom-4 right-4 text-4xl opacity-20 animate-pulse" style="animation-delay: 3s;">
      ğŸ¦‹
    </div>
  </div>
</div>

<style>
  .decorations-container {
    z-index: 5;
  }

  .petal {
    position: absolute;
    animation: fall linear infinite;
    will-change: transform;
  }

  .cupid {
    position: absolute;
    animation: float ease-in-out infinite;
    will-change: transform;
  }

  @keyframes fall {
    0% {
      transform: translateY(-10vh) rotate(0deg) translateX(0);
      opacity: 0;
    }
    10% {
      opacity: var(--petal-opacity, 0.7);
    }
    90% {
      opacity: var(--petal-opacity, 0.7);
    }
    100% {
      transform: translateY(110vh) rotate(720deg) translateX(50px);
      opacity: 0;
    }
  }

  @keyframes float {
    0%, 100% {
      transform: translateY(0) rotate(0deg) scale(1);
    }
    25% {
      transform: translateY(-15px) rotate(5deg) scale(1.05);
    }
    50% {
      transform: translateY(-25px) rotate(0deg) scale(1);
    }
    75% {
      transform: translateY(-15px) rotate(-5deg) scale(1.05);
    }
  }
</style>
